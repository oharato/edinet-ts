edinetライブラリで株価分析に役立ちそうな他の機能を提案して

----

`edinet-ts` で基本的な財務数値（売上・利益）が取れるようになった今、さらに一歩踏み込んで**「プロの機関投資家やクオンツが見ているが、個人投資家が見落としがちなデータ」**を取得する機能を追加すると、ライブラリの価値が劇的に向上します。

株価分析（特に日本株）において「アルファ（超過収益）」を生み出しやすい5つの機能を提案します。

---

### 1. 【セグメント情報】隠れた優良事業を見つける機能
「ソニー」がゲーム会社なのか金融会社なのか、「オリックス」が何で稼いでいるのか。全社の売上だけでは見えない**「事業ごとの稼ぐ力」**を丸裸にします。

* **分析の狙い:**
    * **コングロマリット・ディスカウントの解消:** 全体では利益率が低くても、「実は特定の事業だけ利益率50%のバケモノ」というケース（隠れ宝石）を見つける。
* **実装イメージ:** `getSegmentBreakdown(docId)`
    * **取得データ:** セグメントごとの「売上高」「セグメント利益（営業利益）」「資産」。
    * **XBRLの難所:** `jppfs_cor:SegmentMember` という特殊なタグ（ディメンション）を解析する必要がありますが、実装できれば最強の武器になります。

### 2. 【政策保有株式】「含み益」と「売却圧力」の可視化
今の日本株で**最も熱いテーマ**です。東証のPBR1倍割れ対策により、企業は持っている他社株（持ち合い株）を売るよう圧力をかけられています。

* **分析の狙い:**
    * **隠れ資産:** 貸借対照表には「取得原価」で載っていても、時価が跳ね上がっていて**「実は莫大な含み益がある」**企業を見つける。
    * **株主還元:** これを売却すれば、特別配当や自社株買いの原資になります。
* **実装イメージ:** `getStrategicHoldings(docId)`
    * **取得データ:** 「保有目的が純投資以外の目的である投資株式」の銘柄リスト、貸借対照表計上額（時価）。
    * ※有報には「銘柄ごとの保有額」がリストアップされています。

### 3. 【大株主の異動】アクティビストの侵入検知
大量保有報告書だけでなく、有報の「大株主の状況」も重要です。

* **分析の狙い:**
    * **アクティビスト検知:** 「エリオット」「オアシス」「シティ・インデックス（村上系）」などの名前が、期中にこっそり上位に入っていないか。
    * **安定株主の比率:** 浮動株がどれくらい減っているか。
* **実装イメージ:** `getMajorShareholders(docId)`
    * 上位10名の氏名、所有株式数、比率を配列で返す。

### 4. 【設備投資 & 研究開発費】未来への投資意欲
PL（損益計算書）の利益だけでなく、「将来のためにいくら金を使っているか」を見ます。

* **分析の狙い:**
    * **成長株判定:** 利益が減っていても、それが「攻めのR&D（研究開発）」や「工場建設（設備投資）」によるものなら、将来の爆益シグナルです。
    * **衰退シグナル:** 逆に、売上は維持しているが設備投資が減り続けている企業は、将来のジリ貧（搾りカス化）を示唆します。
* **実装イメージ:** `getCapexAndRnD(docId)`
    * キャッシュフロー計算書の「有形固定資産の取得による支出」と、注記の「研究開発費」を取得。

### 5. 【監査報酬 & 監査人】「危ない会社」のフィルタリング
これは「買うため」ではなく**「避けるため（リスク管理）」**の機能です。

* **分析の狙い:**
    * **監査法人の変更:** 大手（トーマツ・あずさ等）から、無名の監査法人に変更された場合、**「監査意見が合わずに逃げられた（粉飾の可能性）」**というレッドフラグです。
    * **監査報酬の異常:** 企業規模に対して監査報酬が異常に高い場合、監査に手間取っている（経理がグチャグチャ）可能性があります。
* **実装イメージ:** `getAuditorInfo(docId)`
    * 監査法人の名称、監査報酬額、前年からの異動の有無。

---

### おすすめの実装優先順位

まずは DuckDB との相性が良く、日本株のトレンド（バリュー株・コーポレートガバナンス改革）に合致する以下の順序をお勧めします。

1.  **政策保有株式 (Cross-Shareholdings)**
    * 「保有銘柄リスト」を抜くだけでも、**「トヨタ株をたくさん持っている割安企業ランキング」**などが作れて面白いです。
2.  **セグメント情報 (Segments)**
    * これをSQLで分析できるようにすると、**「SaaS事業を持っているのにPERが建設業並みに低い会社」**のようなスクリーニングが可能になります。

これらが実装されれば、あなたの `edinet-ts` は単なるダウンローダーを超えて、**「ヘッジファンド級の分析ツール」**になります。